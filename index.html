<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8" />
  <title>NHL Playoff Bracket Challenge - Round 1</title>
  <script>
    document.addEventListener("DOMContentLoaded", function () {
      const matchups = [
        { id: 1, label: "WSH|MON", teams: ["Washington", "Montreal"] },
        { id: 2, label: "TOR|OTT", teams: ["Toronto",   "Ottawa"]   },
        { id: 3, label: "TBL|FLA", teams: ["Tampa Bay",  "Florida"]   },
        { id: 4, label: "CAR|NJD", teams: ["Carolina",   "New Jersey"]},
        { id: 5, label: "WPG|STL", teams: ["Winnipeg",   "St. Louis"] },
        { id: 6, label: "VGK|MIN", teams: ["Vegas",      "Minnesota"] },
        { id: 7, label: "DAL|COL", teams: ["Dallas",     "Colorado"]  },
        { id: 8, label: "LAK|EDM", teams: ["Los Angeles","Edmonton"]  }
      ];

      const form = document.getElementById("playoffForm");

      // Build the form fields for each series
      matchups.forEach(m => {
        const fs = document.createElement("fieldset");
        fs.innerHTML = `
          <legend>Matchup ${m.id}: ${m.label}</legend>
          <label>Pick Winner:
            <select name="winner${m.id}">
              ${m.teams.map(t => `<option>${t}</option>`).join("")}
            </select>
          </label><br>
          <label>Pick Number of Games:
            <select name="games${m.id}">
              ${[4,5,6,7].map(n => `<option>${n}</option>`).join("")}
            </select>
          </label><br>
          <label>Pick X‑Factor Player:
            <select name="xfactor${m.id}" id="xfactor${m.id}">
              <option>Loading...</option>
            </select>
          </label>
        `;
        form.insertBefore(fs, document.getElementById("submitButton"));
      });

      // JSONP callback to populate X‑Factor dropdowns
      window.populateXFactors = function(data) {
        matchups.forEach(m => {
          const sel = document.getElementById(`xfactor${m.id}`);
          sel.innerHTML = "";  // clear Loading...
          (data.players[m.label] || []).forEach(p => {
            const opt = document.createElement("option");
            opt.value = p;
            opt.textContent = p;
            sel.appendChild(opt);
          });
        });
      };

      // Insert the JSONP <script> tag to fetch X‑Factor data
      const s = document.createElement("script");
      s.src = "https://script.google.com/macros/s/AKfycbz7YYcbwbnWuHajLNypDJaxg3Lc4GSfaVL0VX-NKzeOB8IdiWrBWnuiPJMVLnAaWzUS_w/exec"
            + "?get=xfactors"
            + "&callback=populateXFactors";
      document.head.appendChild(s);
    });
  </script>
</head>
<body>
  <h1>NHL Playoff Bracket Challenge - Round 1</h1>
  <form id="playoffForm"
        method="POST"
        action="https://script.google.com/macros/s/AKfycbz7YYcbwbnWuHajLNypDJaxg3Lc4GSfaVL0VX-NKzeOB8IdiWrBWnuiPJMVLnAaWzUS_w/exec">
    <label>Your Name:
      <input type="text" name="name" required>
    </label><br><br>
    <button id="submitButton" type="submit">Submit Picks</button>
  </form>
</body>
</html>

